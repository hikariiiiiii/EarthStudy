# 货币存储

## 如何储存和使用比特币

储存比特币就是储存与管理比特币私钥

三个目标：获取性、安全性、便利性

 

### 简单的本地设备储存

获取性、安全性差

一般会使用比特币钱包软件

 

地址使用Base58对二进制字符进行编码

交换地址一般使用字符串或QR二维码

虚荣地址（vanity address）：使用工具不停生成私钥，以达到含有个性化字符的地址（平均生成58的k次方次地址，k为个性化字符的个数）

 

### 特储存与冷储存

热储存：连入互联网，随时可以给冷储存转账

冷储存：不连入互联网，生成地址发送给热储存

 

第一种方法

分层确定性钱包（hierarchical deterministic wallet）：可让冷储存制造无限制的地址数量，一次性让热储存知晓所有地址

生成“密钥生成信息”和“地址生成信息”来代替“密钥”和“地址”

比特币使用的ECDSA支持分层密钥

 

生成分层确定性密钥需要两个随机数k、y

私钥生成信息：k、y

第i个私钥：xi = H( k || i ) +y

地址生成信息：k、gy

第i个公钥：gxi= g H( k || i ) · gy 

第i个地址：H(gxi)

 

第二种方法

大脑钱包（brain wallet）：用一个可预测的算法把一个口令变成一对公钥/私钥，还可结合分层确定性钱包技术生成一整套地址和私钥

 

第三种方法

纸钱包：将密钥印在纸上，二维码或base58编码

 

第四种方法

防损硬件（tamper-resistant device）

 

### 密钥分存和密钥共享

密钥分存：将密钥转换成N个子密钥，只要获取K（K<=N）个子密钥，就可以还原原密钥。如果获得的子密钥少于K，则无法知道关于原密钥的任何信息

若K=N，可以先生成N-1个随机数，然后最后一个子密钥就是原密钥与所有其他N-1个子密钥的异或

若K<N，使用自由度为K-1的曲线上的N个点来进行密钥分存，( S + R1X + R2X2 + … + RK-1XK-1 ) mod P，R为随机数，P为足够大的素数

 

门限密码（threshold cryptography）

门限签名（threshold signature）

可实现双重安全机制或多重安全机制

 

多重签名（multisignature）

可实现多人对共同财产实现共同控制

通过比特币脚本把一个比特币的控制权交给多个密钥

 

### 在线钱包和交易所

在线钱包：将密钥储存在云端（Coinbase、blockchain.info）

 

比特币交易所

和银行一样主要面临三大类风险：

1. 挤兑
2. 庞氏骗局
3. 黑客入侵

银行有政府的监管：

1. 最低准备金要求
2. 投资类型、资金管理监管
3. 提供必要保护

交易所的措施：

1. 准备金证明（proof of reserve），证明其“至少”有多少准备金，交易所发起一笔收款人是自身的交易，之后用同一私钥为一条查询指令签名，这个查询指令是公正第三方随意发出的字符串
2. 负债证明（proof of liabilities），证明其“至多”有多少存款，交易所构建一个梅克尔树（叶子节点为所有储户信息，每个节点增加一个金额字段，该字段显示最近两个子节点的金额之和），然后将根节点加密签名后广播

3. “准备金”（provision）协议，可提供偿付能力证明，无需披露总负债和总的存款准备金规模

   准备金证明和负债证明会泄露很多私密信息，实际应用中用的很少

 

### 支付服务

支付服务一般流程：

客户购买 – 支付服务商提供比特币支付按钮 – 客户付款给支付服务商 – 支付服务商给商户发送支付凭证 – 客户购买成功 – 支付服务商定时结算指定货币给商户

该流程支付服务商几乎承担了所有风险

 

2015年初无需交易费默认条件：

1. 交易小于1000个字节

2. 所有输出为0.01BTC或更大

3. 优先权足够高

   优先权 = 所有（账龄x输入金额）的总和 / 交易规模

   账龄 = 输入对应的上一笔交易到现在所经过的时间

2015年初交易费默认标准：每1000个字节需要支付0.0001BTC



### 货币兑换市场

简单的市场行为模型：

P = TD/S

P为比特币价格

T为比特币价格对应货币的交易量（每秒）

D为比特币处于交易状态的时间间隔（暂时退出流通体系）

S为比特币总量