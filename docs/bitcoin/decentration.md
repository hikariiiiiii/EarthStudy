# 去中心化

## 比特币如何做到去中心化

### 去中心化

**去中心化（Decentralization）**：在一个分布有众多节点的系统中，每个节点都具有高度自治的特征。节点之间可以自有链接，形成新的连接单元。任何一个节点都可能成为阶段性的中心，但不具备强制性的中心控制模式。节点与节点之间的影响，会通过网络而形成非线性因果关系。这种开放式、扁平化、平等性的系统现象或结构，被称为去中心化。

没有一个系统是完全**中心化（Centralization）**或完全去中心化的，去中心化不是不要中心，而是由节点来自由选择中心、自由决定中心。简单地说，中心化的意思，是中心决定节点。节点必须依赖中心，节点离开了中心就无法生存。在去中心化系统中，任何人都是一个节点，任何人也都可以成为一个中心。任何中心都不是永久的，而是阶段性的，任何中心对节点都不具有强制性。

### 分布式共识

##### 共识（consensus）

##### 分布式共识协议（distributed consensus protocol）

在一个有n个节点的系统中，每一个节点都有一个输入值，其中一些节点具有故障，甚至是恶意的。一个分布式共识协议有以下两个属性：

1. 输入值的中止必须经由所有诚实节点来确定
2. 这个输入值必须由诚实节点来生成

 

比特币是一个点对点系统

比特币协议达成共识时直面两大障碍：

1. 不完美的网络，例如信息延迟和节点死机
2. 某些故意搞破坏的节点

 

**拜占庭将军问题（Byzantine Generals Problem）**

如果叛徒数量超过1/3，则无法达成统一的作战计划

**不可能结果（Fischer-Lynch-Paterson）**

在一定条件下（包括节点行为具有确定特征），甚至在只有一个缺陷的过程中，达成共识都是不可能的

**Paxos算法协议**

一方面做到不产生不一致结果；另一方面做出妥协：在一定条件下，协议会死机卡住，无法继续运行



以上三个问题都是针对分布式数据库的研究，而比特币打破了很多原来分布式数据库所做的假设。

比特币打破的假设：

1. 引进了奖励的理念
2. 包含随机性概念

 

### 使用区块链达成没有身份的共识

**化名制（pseudonyity）**，缺少真实身份

**隐性共识（inplicit consensus）**，共识协议有多个回合，每个回合随机选取一个节点提议下一个区块，其他节点通过隐性接受或拒绝，如果接受则在该区块之后接龙下去，如果拒绝则忽略该区块而选择曾经接受的区块然后接龙下去

1. 新的交易被广播到所有节点之上
2. 每个节点都将新的交易放进一个区块
3. 在每个回合，一个随机的节点可以广播它的区块
4. 其他节点可以选择接受这个区块，前提是如果区块里的交易都是正当的（有真的签名）
5. 节点们可以把以上区块的哈希值放进自己的区块里，以此来表示他们对那个新区块的认可

可避免的攻击：窃取比特币、拒绝服务攻击、双重支付攻击（商家需通过多次确认交易来避免双重支付攻击，一般是6个确认）



**孤块（orphan block）**：被网络完全遗忘的链块

**零验证交易（zero confirmation transaction）**：在没有区块被创建之前就完成交易

诚实节点一般会延长最长有效分支

 

### 奖励机制与工作量证明

**奖励机制** ：比特币创造的唯一途径

奖励一：区块奖励，每创建一个区块，可在该区块中加入一笔奖励交易，地址由区块创建者指定。最初奖励为50个比特币，每生成210000个区块，奖励减半，最终限制比特币上限为2100万个

奖励二：交易费，交易的制造者可以让交易输出值比输入值小，而第一个节点的区块创建者能将这个差额付到指定的地址中

 

**工作量证明（proof of work）**

核心理念是把随机选取节点改为根据节点占有某种资源的比例来选取节点，该资源是无法垄断的，比如计算能力

**权益证明（proof of stake）**

某种币的拥有量



工作量证明函数三个特性：

1. 难于计算，挖矿成本高
2. 可参数化成本，每产生2016个区块之后，所有节点会自动重新计算目标区域的比例大小，使得后续区块产生的时间间隔约为10分钟
3. 易于证实，其他节点很容易就能验证随机数的正确性

 

**比特币挖矿**：解哈希谜题

```
  H( nonce || prev_hash || tx || tx || … || tx ) < target 
```

**挖矿能力**：哈希速度（哈希/秒）



**比特币最小单位**：1中本聪 = 0.00000001 BTC（1E-8）



### 总结

**比特币的共识**：

账本情况、拥有的比特币、系统规则都是通过共识表达的



区块链安全性 – 挖矿生态系统的健康程度 – 货币的价值 三者相互作用的**自举过程（bootstrapping）**

 

**51%攻击**： 成本极高，且开发者可升级比特币来应对，但51%攻击的存在本身就是大家对比特币信息的巨大威胁